{include file="./public/header" }<div class="ns-main w1200">    <div class="findpassword w1200 clearfix">        <div class="head-block">            <a class="self-adaption-block" href="/">                <img class="self-adaption-img" alt="91AMZ 简单选品 选品简单" src="__IMG__/logo.png" style="width:100%;">            </a>            <span>找回密码</span>        </div>        <div><a href="/">返回首页</a></div>    </div>    <div class="find-process">        <ul>            <li class="current">                <div>                    <p>1</p>                    <p>输入账号</p>                </div>                <span class="line-2"></span>            </li>            <li id="current2">                <span class="line-1"></span>                <div>                    <p>2</p>                    <p>验证身份</p>                </div>                <span class="line-2"></span>            </li>            <li id="current3">                <span class="line-1"></span>                <div>                    <p>3</p>                    <p>重置密码</p>                </div>                <span class="line-2"></span>            </li>            <li id="current4">                <span class="line-1"></span>                <div>                    <p>4</p>                    <p>完成</p>                </div>            </li>        </ul>        <ol>            <!-- 输入帐户名 -->            <li class="js-input-account">                <div class="item">                    <label>账号</label>                    <input class="form-control form-control-sm " id="mobile" maxlength="11" type="text" placeholder="手机号" onKeyPress="if (event.keyCode == 13) jsInputAccount();">                    <span class="ns-text-color" id="tip_account"></span>                </div>                <div class="item captcha">                    <label>验证码</label>                    <input type="text" id="captcha" maxlength="4" name="captcha" placeholder="" autocomplete="off" class="form-control form-control-sm " onKeyPress="if (event.keyCode == 13) jsInputAccount();"  />                    <img class="img-captcha verifyimg" src="/website/verify" onclick="this.src='/website/verify?tag=1'+'&send='+Math.random()" alt="看不清; 点击更换验证码;" title="看不清; 点击更换验证码;" style="vertical-align: middle; cursor: pointer; height: 35px;" />                    <span class="ns-text-color" id="tip_captcha"></span>                </div>                <div class="item mb-9">                    <button class="btn btn-primary" type="button">下一步</button>                </div>            </li>            <!-- 验证身份 -->            <li class="js-verify none">                <div class="item">                    <label>验证方式</label>                    <span id="verific_mode"></span>                </div>                <div class="item">                    <label>用户名</label>                    <span id="nickname_info"></span>                </div>                <div class="item">                    <label id="code"></label>                    <input id="sms_code" maxlength="6" class="form-control form-control-sm" type="text" onKeyPress="if (event.keyCode == 13) jsVerify();" >                    <button  class=" btn btn-primary btn-sm btn-block code" style="font-size: 12px; width: 104px; height: 35px; display: inline-block; text-align: center; margin-left: 10px;" onclick="getCode(this);" type="button" >                        获取手机验证码                    </button>                    <span id="tip_sms_code" class="ns-text-color"></span>                </div>                <div class="item mb-9 next">                    <button class="btn btn-primary" type="button">下一步</button>                </div>            </li>            <!-- 重置密码 -->            <li class="js-reset none">                <div class="item">                    <label>设置新密码</label>                    <input class="form-control form-control-sm" type="password" id="newpass" onKeyPress="if (event.keyCode == 13) jsReset();"  >                    <span class="ns-text-color" id="newpassinfo"></span>                </div>                <div class="item">                    <label>确认新密码</label>                    <input class="form-control form-control-sm" type="password" id="confirmpass" onKeyPress="if (event.keyCode == 13) jsReset();"  >                    <span class="ns-text-color" id="confirmpassinfo"></span>                </div>                <div class="item mb-9">                    <button class="btn btn-primary" type="button">下一步</button>                </div>            </li>            <!-- 新密码重置完成 -->            <li class="js-finish verify-success none" id="finish_password">                <p>新密码重置完成!</p>                <a href="/website/login" class="back-index ns-bg-color">重新登录</a>            </li>        </ol>    </div>    <input type="hidden" value="1" id="login_verify_code"></div><script>    $(document).ready(function () {        //输入账户名        $(".js-input-account button").click(function () {            jsInputAccount();        });        //验证身份点击下一步        $(".js-verify .next").click(function () {            jsVerify();        });        //重置密码点击下一步        $(".js-reset button").click(function () {            jsReset();        })    });    //倒计时    var wait = 60;    function countDown(chageObj, oldText) {        //var time = time != undefined ? time : 60,            oldText = oldText != undefined ? oldText : '获取动态码',            text = wait + 's后重新获取';        if (wait > 0) {            $(chageObj).text(text).addClass('disabled');            wait -= 1;            setTimeout(function () {                countDown(chageObj, oldText);            }, 1000);        } else {            console.log(wait);            $(chageObj).text(oldText).removeClass('disabled');        }    }    //发送短信验证码    function getCode(event){        var mobile = $("#mobile").val();        var type = "findPasswd";        var isDisabled = $(".code").hasClass("disabled");        var self = event;        if(!isDisabled){            countDown(event);            //发送手机邮箱验证码            $.post("/website/sms", {"type": type, "mobile": mobile}, function (res) {                if (res.status == "error") {                    layer.msg(res.msg);                    wait = 0;                    countDown(self, "获取动态码");                    return false;                }            }, "json");        }    }    function jsReset(){        var new_pass = $("#newpass").val();        var confirm_pass = $("#confirmpass").val();        var mobile = $("#mobile").val();        var sms_code = $("#sms_code").val();        if (new_pass.length < 6) {            $("#newpass").trigger("focus").addClass("ns-border-color");            $("#newpassinfo").text("密码长度不足6位");            return false;        }        if (confirm_pass != new_pass) {            $("#confirmpass").trigger("focus").addClass("ns-border-color");            $("#confirmpassinfo").text("两次输入密码不一致");            return false;        }        $.post("/website/passwdReset", {            "mobile": mobile,            "password": new_pass,            "code" : sms_code,            "type":"findPasswd"        }, function (res) {            console.log(res);            if (res.status == "success") {                $(".js-reset").hide();                $(".js-finish").show();                $("#current4").attr("class", "current");                $("#current4 > .line-1").addClass("ns-border-color");            } else {                layer.msg("新密码与旧密码相同，请重新设置密码！");                // setTimeout(function () {                //     location.reload()                // }, 2000);                return false;            }        },"json")    }    function jsVerify(){        var sms_code = $("#sms_code").val();        var verific = $("#verific_mode").html();        console.log("验证码");        if (sms_code.length == 0) {            $("#sms_code").trigger("focus").addClass("ns-border-color");            $("#tip_sms_code").text(verific + "验证码不能为空");            return false;        } else {            $.post("/website/checkFindPasswdCode", {"send_param": sms_code}, function (res) {                console.log(res);                if(res.status == "success"){                    $(".js-verify").hide();                    $(".js-reset").show();                    $("#current3").attr("class", "current");                    $("#current3 > .line-1").addClass("ns-border-color");                } else {                    $("#sms_code").trigger("focus").addClass("ns-border-color");                    $("#tip_sms_code").text(res.msg);                    return false;                }            },'json')        }    }    function jsInputAccount(){        var mobile = $("#mobile").val();        var captcha = $("#captcha").val();        var type = "";        if (mobile.length == 0) {            $("#mobile").trigger("focus").addClass("ns-border-color");            $("#tip_account").text("手机号不能为空");            return false;        } else {            $("#mobile").removeClass("ns-border-color");            $("#tip_account").text("");        }        if (mobile.search(regex.mobile) == -1) {            $("#mobile").trigger("focus").addClass("ns-border-color");            $("#tip_account").text("手机号码不正确");            return false;        } else {            $("#mobile").removeClass("ns-border-color");            $("#tip_account").text("");        }        if (mobile.search(regex.mobile) != -1) {            $("#verific_mode").text("手机验证");            $("#verified").text("验证码");            $("#code").text("手机验证码");            $(".code").text("获取手机验证码");        }        if ($("#login_verify_code").val() == 1) {            if (captcha.length == 0) {                $("#captcha").trigger("focus").addClass("ns-border-color");                $("#tip_captcha").text("手机验证码不能为空");                return false;            } else {                $("#captcha").removeClass("ns-border-color");                $("#tip_captcha").text("");            }            var check_captcha = true;//检测验证码是否正确，            $.ajax({                type:"post",                url:"/website/checkCaptcha",                data:"vertification="+captcha,                dataType:'json',                async:false,                success:function(res){                    if (res.status == "success") {                        check_captcha = false;                    } else {                        $("#captcha").trigger("focus").addClass("ns-border-color");                        $(".img-captcha").attr("src",  '/website/verify?tag=1&send=' + Math.random());                        $("#tip_captcha").text(res.msg);                    }                }            });            if (check_captcha)            {                return false;            }        }        var myinfo = mobile.substr(3, 4);        var deinfo = mobile.replace(myinfo, "****");        $("#verified_info").text(deinfo);        //校验手机号        $.post("/website/findPasswd", { mobile: mobile}, function (res) {            if(res.status == "success"){                $(".js-input-account").hide();                $(".js-verify").show();                $("#current2").attr("class", "current");                $("#current2 > .line-1").addClass("ns-border-color");                $("#nickname_info").text(deinfo);            } else {                $("#mobile").trigger("focus").addClass("ns-border-color");                $("#tip_account").text(res.msg);                return false;            }        },"json");    };</script>{include file="./public/footer" }