{include file="./public/header" }{include file="./public/navbar" }<style>    .ns-main {        overflow: hidden;        height:800px;    }    .member-main {        background: #fff;        overflow: hidden;        margin-top: 20px;        padding: 20px;    }    .tab-pane {        padding-top: 20px;    }    .tab-pane .btn-default {        color: #fff;        text-shadow: none;    }    .head-img {        width: 120px;        height: 120px;        border: 1px solid #e6e6e6;        text-align: center;        line-height: 100px;        margin: 20px 0;    }    .head-img > div {        width: 120px;        height: 120px;        margin: 0 auto;        line-height: 120px;    }    .head-img > div img {        max-height: 100%;        padding: 5px;    }    .form-control-static {        min-height: 33px;        padding-top: 6px;        padding-bottom: 6px;        margin-bottom: 0;    }    .form-group .col-sm-3,.form-group .col-sm-9{        display: inline-block;    }</style><div class="ns-main w1200">    {include file="./public/member_menu" }    <script type="text/javascript">        $(function () {            $(".member-menu ul li a[href='" + String(location) + "']").addClass("ns-text-color");        });    </script>    {css href="__STATIC__/webuploader/webuploader.css" rel="stylesheet"}    <div class="member-main">        <ul class="nav nav-tabs">            <li class="active"><a data-tab="tab1" href="#base_info">基本信息</a></li>            <li><a data-tab="tab2" href="#update_face">头像照片</a></li>        </ul>        <div class="tab-content">            <div class="tab-pane active" id="tab1">                <div class="form-horizontal">                    <div class="form-group row mb-4">                        <label class="col-sm-2">手机号：</label>                        <div class="col-sm-4">                            {if $userInfo.userMobile}                            <p class="form-control-static personal-nick">{$userInfo.userMobile}</p>                            {else/}                            <button class="btn btn-primary" onclick="javascript:window.location.href='/website/perfectInfo'" >绑定手机号</button>                            {/if}                        </div>                    </div>                    <div class="form-group row mb-4">                        <label class="col-sm-2">昵称：</label>                        <div class="col-sm-4">                            <input type="text" class="form-control form-control-sm" name="nick_name" value="{$userInfo.nickName}" placeholder="请填写您的昵称">                        </div>                    </div>                    <div class="form-group row mb-4">                        <label class="col-sm-2">邮箱：</label>                        <div class="col-sm-4">                            <input type="text" class="form-control form-control-sm" name="user_email" value="{$userInfo.userEmail}" placeholder="请填写您的邮箱号码">                        </div>                    </div>                    <div class="form-group row mb-4">                        <label class="col-sm-2">QQ：</label>                        <div class="col-sm-4">                            <input type="text" class="form-control form-control-sm" name="user_qq" value="{$userInfo.userQQ}" placeholder="请填写您的QQ号">                        </div>                    </div>                    <div class="form-group row mb-4">                        <label class="col-sm-2">出生日期：</label>                        <div class="col-sm-4">                            <input type="date" class="form-control form-control-sm" name="birthday" value="{$userInfo.userBirthday}" placeholder="">                        </div>                    </div>                    <div class="form-group row mb-4">                        <label class="col-sm-2">所在地：</label>                        <div class="col-sm-4">                            <input type="text" class="form-control form-control-sm" name="location" value="{$userInfo.userLocation}" placeholder="请填写您的所在地址">                        </div>                    </div>                    <div class="form-group row mb-4">                        <div class="col-12 col-sm-2 offset-sm-4">                            <button class="btn btn-sm btn-block btn-primary" type="button" onclick="updateBasicsInfo();">                                <span class="iconfont icon-correct font-size-1 mr-1"></span>保存                            </button>                        </div>                    </div>                </div>            </div>            <div class="tab-pane" id="tab2" style="display:none;">                <form class="form-horizontal">                    <div class="form-group" style="height:200px;">                        <label class="col-sm-2">头像预览</label>                        <div class="col-sm-9">                            <p class="hint ns-text-color">完善个人信息资料，头像最佳默认尺寸为120x120像素。</p>                            <div class="head-img webuploader-container">                                <div class="webuploader-pick">                                    <img alt="" src="{$userInfo.userFace}" id="headimg" style="width:100%;">                                </div>                                <div id="rt_rt_1dc8clfou7rig05q9t27iq7t1" style="position: absolute; overflow: hidden; bottom: auto; right: auto; width: 120px; height: 120px; top: 0px; left: 0px;">                                    <input type="file" name="file" class="webuploader-element-invisible" multiple="multiple" accept="image/*">                                    <label style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>                                </div>                            </div>                        </div>                    </div>                    <div class="form-group">                        <div class="col-12 col-sm-2 offset-sm-4" >                            <button class="btn btn-primary btn-sm btn-block js-save" type="button">                                <span class="iconfont icon-correct font-size-1 mr-1"></span>                                保存                            </button>                        </div>                    </div>                </form>            </div>        </div>    </div></div><script type="text/javascript" src="__STATIC__/webuploader/webuploader.js"></script><script>    var uploader;    var curr_file;    // 修改用户基础信息    function updateBasicsInfo() {        if (verify()) {            var info_data = {                nickName: $('[name="nick_name"]').val(),                userEmail: $('[name="user_email"]').val(),                userQQ: $('[name="user_qq"]').val(),                userLocation: $('[name="location"]').val(),                userBirthday: $('[name="birthday"]').val(),            };            $.post('/website/updateUserInfo', info_data, function (data) {                console.log(data);                if ( data.status == "success" ) {                    layer.msg(data.msg);                    setTimeout(function () {                        location.reload();                    }, 1000)                } else {                    layer.msg(data.msg);                }            },"json")        }    }    // 验证    function verify() {        if ( $.trim($("input[name=nick_name]").val()).length == 0) {            layer.msg('请输入昵称');            return false;        }        if ( $.trim($("input[name=user_email]").val()).length == 0) {            layer.msg('请输入邮箱');            return false;        }        return true;    }    $(function () {        uploader = WebUploader.create({            auto : false,            // 文件接收服务端。            server: '/website/uploadImage',            // 选择文件的按钮。可选。            // 内部根据当前运行是创建，可能是input元素，也可能是flash.            pick: '.head-img',            fileNumLimit: 1,            // 不压缩image, 默认如果是jpeg，文件上传前会压缩一把再上传！            resize: false,            // 只允许选择图片文件。            accept: {                title: 'Images',                extensions: 'gif,jpg,jpeg,bmp,png',                mimeTypes: 'image/*'            },            formData: {                param: JSON.stringify({                    // app_key :APP_KEY                })            },            thumb: {                width: 300,                height: 300,                crop: false            }        });        // 当有文件被添加进队列的时候        uploader.on('fileQueued', function (file) {            curr_file = file;            uploader.makeThumb(file, function (error, src) {                if (error) {                    $("#headimg").replaceWith('<span>不能预览</span>');                    return;                }                $("#headimg").attr('src', src);                $('.js-save').removeClass('upload-save');            });        });        uploader.on('uploadSuccess', function (file, res) {            $.post('/website/memberModifyFace', {"user_headimg": res.data.pic_cover}, function (data) {                //删除文件                if (curr_file) uploader.removeFile(curr_file);                if (data.status == "success") {                    layer.msg('保存成功');                    setTimeout(function () {                        location.reload();                    }, 1000)                } else {                    layer.msg(data.msg);                }            },"json");        });        $(".js-save").click(function () {            if (uploader.getFiles().length) uploader.upload();            else location.reload();        });        //切换tab        $(".nav-tabs li").click(function(){            $(this).siblings().removeClass("active");            $(this).addClass("active");            var tab = $(this).children("a").data("tab");            if(tab == "tab1"){                $("#tab1").show();                $("#tab2").hide();            } else if (tab == "tab2"){                $("#tab2").show();                $("#tab1").hide();            }        });    });</script>{include file="./public/footer" }