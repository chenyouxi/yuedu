<?php/** * * +---------------------------------------------------------------------- *                      .::::. *                    .::::::::.            | AUTHOR: chenyouxi *                    :::::::::::           | EMAIL: 905100794@qq.com *                 ..:::::::::::'           | QQ: 905100794 *             '::::::::::::'               | WECHAT: xi20130618 *                .::::::::::               | DATETIME: 2019/7/18 4:34 PM *           '::::::::::::::.. *                ..::::::::::::. *              ``:::::::::::::::: *               ::::``:::::::::'        .:::. *              ::::'   ':::::'       .::::::::. *            .::::'      ::::     .:::::::'::::. *           .:::'       :::::  .:::::::::' ':::::. *          .::'        :::::.:::::::::'      ':::::. *         .::'         ::::::::::::::'         ``::::. *     ...:::           ::::::::::::'              ``::. *   ```` ':.          ':::::::::'                  ::::.. *                      '.:::::'                    ':'````.. * +---------------------------------------------------------------------- */namespace app\common\service;use app\common\model\AuthRuleModel as AuthRuleModel;use think\facade\Request;class AuthRuleService{    private $authRule;    function __construct()    {        $this->authRule = new AuthRuleModel();    }    /**     * @param $page_index     * @param $page_size     * @param $condition     * @param $order     * @param $type     * @return \app\common\model\multitype     * 获取列表     */    public function getList($page_index, $page_size, $condition, $order,$type){        $list = $this->authRule->viewPageQuery($this->authRule, $page_index, $page_size, $condition, $order,$type);        return $list;    }    /**     * @param $condition     * @param $field     * @param $order     * @param string $group     */    public function getQuery($condition, $field, $order, $group=''){        $list = $this->authRule->getQuery($condition, $field, $order, $group='');        return $list;    }    /**     * 获得面包导航     * @param string $path     * @return array     */    public function getBreadCrumb($route = '')    {        //当前URL        $route = $route ? $route : Request::controller() . '/' . lcfirst(Request::action());        //查找名称        $data = $this->authRule->getInfo(['name'=> $route]);        $result = [];        if ($data) {            $result[] = [                'url'   => $data['name'],                'title' => $data['title'],                'icon'  => $data['icon'],            ];            //查找是否有上级别            if ($data['pid']) {                //查询上级url                $route = $this->authRule->getInfo(['autoId' => $data['pid']]);                $crumb = $this->getBreadCrumb($route['name']);                foreach ($crumb as $k => $v) {                    $result[] = [                        'url'   => $crumb[$k]['url'],                        'title' => $crumb[$k]['title'],                        'icon'  => $crumb[$k]['icon']                    ];                }            }        } else {            //不存在的记录            if ($route == 'Index/index') {                $result[] = [                    'url'   => 'Index/index',                    'title' => '控制台',                    'icon'  => 'fa fa-dashboard',                ];            }        }        return $result;    }}