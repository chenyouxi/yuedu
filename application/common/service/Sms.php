<?php/** * Created by PhpStorm. * User: chenyouxi * Date: 2019/6/5 * Time: 12:01 PM */namespace app\common\service;use think\facade\Session as Session;use think\facade\Cookie as Cookie;use think\facade\Cache;use app\common\service\BaseService as BaseService;use app\common\model\SmsModel as SmsModel;use think\Db;class Sms extends BaseService{    function __construct()    {        parent::__construct();        $this->sms = new SmsModel();    }    public function getList($page_index, $page_size, $condition, $order,$type=""){        $list = $this->sms->viewPageQuery($this->sms, $page_index, $page_size, $condition, $order,$type);        foreach($list as $key => &$value){            $value['content'] = htmlspecialchars_decode($value['content']);        }        return $list;    }    public function addSms( $userId, $content ){        $data = [            'userId' => $userId,            'content' => $content,            'smsType' => '-1',            'status' => '-1',            'addTime' => time()        ];        $res = $this -> sms -> insertGetId($data);        return $res;    }    /**     * 更新消息状态     */    public function updateByMsmStatus( $userId ){        $where = [            "userId" => $userId,            "status" => "-1",            "smsType" => "1"//管理员信息        ];        $data = [            'status' => 1        ];        $res = $this -> sms -> where( $where ) -> update($data);        return $res;    }    /**     * 获取未读消息总数     */    public function getCount($condition){        $num = $this->sms->getCount( $condition );        return $num;    }}